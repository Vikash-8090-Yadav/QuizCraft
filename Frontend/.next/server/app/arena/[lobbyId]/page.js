(()=>{var e={};e.id=244,e.ids=[244],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5245:(e,s,t)=>{Promise.resolve().then(t.bind(t,31373))},5336:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5423:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16189:(e,s,t)=>{"use strict";var a=t(65773);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},28947:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31373:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>H});var a=t(60687),r=t(76180),l=t.n(r),n=t(43210),i=t(16189),o=t(24934),d=t(55192),c=t(59821);let x=0,m=new Map,u=e=>{if(m.has(e))return;let s=setTimeout(()=>{m.delete(e),b({type:"REMOVE_TOAST",toastId:e})},1e6);m.set(e,s)},h=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?u(t):e.toasts.forEach(e=>{u(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},f=[],g={toasts:[]};function b(e){g=h(g,e),f.forEach(e=>{e(g)})}function p({...e}){let s=(x=(x+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>b({type:"DISMISS_TOAST",toastId:s});return b({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:e=>{e||t()}}}),{id:s,dismiss:t,update:e=>b({type:"UPDATE_TOAST",toast:{...e,id:s}})}}var j=t(99253),y=(t(70193),t(91180)),N=t(90573),w=t(87987),v=t(92002),A=t(19361),S=t(47052),C=t(92363),k=t(45583),$=t(67268),z=t(62688);let _=(0,z.A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),P=(0,z.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var I=t(41312),L=t(77306),T=t(48730);let M=(0,z.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var F=t(5336),D=t(41862),E=t(28947);function R({currentQuestion:e,totalQuestions:s,playerScore:t,timeRemaining:r,questionDuration:l,playersFinished:n,totalPlayers:i,isLastQuestion:o=!1,questionSource:c=null}){let x=Math.min(e+1,s),m=x/s*100,u=Math.max(0,Math.min(100,r/l*100)),h=r<=5,f=r<=2,g=f?"from-red-600 via-red-500 to-orange-500 animate-pulse":h?"from-rose-500 via-red-500 to-orange-500":"from-emerald-500 via-green-500 to-teal-500";return(0,a.jsx)("div",{className:"sticky top-20 z-40 w-full mb-6 px-4 animate-in slide-in-from-top-4 duration-500",children:(0,a.jsx)(d.Zp,{className:"border-0 shadow-2xl bg-gradient-to-r from-white via-blue-50/40 to-purple-50/40 backdrop-blur-xl hover:shadow-3xl transition-all duration-300",style:{borderRadius:16},children:(0,a.jsxs)(d.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-blue-100",children:(0,a.jsx)(E.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Question"}),(0,a.jsxs)("div",{className:"text-lg font-bold text-blue-600",children:[x,"/",s]})]})]}),(0,a.jsxs)("div",{className:"w-28",children:[(0,a.jsx)("div",{className:"h-2 w-full rounded-full bg-gray-200 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 via-blue-500 to-cyan-500 transition-all",style:{width:`${Math.min(100,Math.max(0,m))}%`}})}),(0,a.jsxs)("div",{className:"text-xs text-center text-gray-600 mt-1 font-semibold",children:[Math.round(m),"%"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,a.jsx)($.A,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Score"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:t.toLocaleString()})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,a.jsx)(T.A,{className:`h-4 w-4 ${f?"text-red-600 animate-pulse":h?"text-red-600":"text-orange-600"}`}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Time"})]}),(0,a.jsxs)("div",{className:`text-2xl font-bold transition-colors duration-300 ${f?"text-red-600 animate-pulse":h?"text-red-600":"text-emerald-600"}`,children:[Math.max(0,r),"s"]}),f&&(0,a.jsx)("div",{className:"text-xs text-red-600 font-bold animate-bounce",children:"\uD83D\uDEA8 CRITICAL!"}),h&&!f&&(0,a.jsx)("div",{className:"text-xs text-red-600 font-medium animate-pulse",children:"âš ï¸ Hurry!"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,a.jsx)(I.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Players"})]}),(0,a.jsxs)("div",{className:"text-lg font-bold text-blue-600",children:[n,"/",i]}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:n===i?"All done!":"playing"})]}),c&&(0,a.jsx)("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${"ai"===c?"bg-gradient-to-r from-purple-500 to-indigo-500 text-white":"bg-gradient-to-r from-orange-500 to-red-500 text-white"}`,children:"ai"===c?"\uD83E\uDD16 AI Questions":"\uD83D\uDCDA Fallback"}),o&&(0,a.jsx)("div",{className:"px-3 py-1 bg-gradient-to-r from-fuchsia-500 to-pink-500 text-white rounded-full text-sm font-bold animate-pulse",children:"\uD83C\uDF89 Final Q!"})]})]}),(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,a.jsxs)("div",{className:"relative h-4 rounded-full overflow-hidden bg-gray-200 shadow-inner",children:[(0,a.jsx)("div",{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${g} transition-all duration-500 ease-out`,style:{width:`${Math.min(100,Math.max(0,u))}%`}}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("span",{className:`text-[11px] font-bold transition-colors duration-300 ${f?"text-white":h?"text-red-800":"text-gray-700"}`,children:[Math.round(u),"% time left"]})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,a.jsxs)("span",{children:["Question ",x," of ",s]}),(0,a.jsxs)("span",{children:[Math.round(m),"% complete"]})]})]})]})})})}var q=t(5423),Q=t(86561),Z=t(64398);let O=(0,z.A)("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),U=(0,z.A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),W=(0,z.A)("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);function G({results:e,lobbyId:s,currentPlayerAddress:t,onPlayAgain:r,onBackToLobby:i}){let[x,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),[f,g]=(0,n.useState)(!1),b=e.filter(e=>e.has_played).sort((e,s)=>s.score-e.score),j=e=>0===e?(0,a.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center bg-gradient-to-br from-yellow-400 to-yellow-600 border-4 border-yellow-500 shadow-2xl shadow-yellow-500/50 animate-bounce",children:(0,a.jsx)(C.A,{className:"h-8 w-8 text-white"})}):1===e?(0,a.jsx)("div",{className:"w-14 h-14 rounded-full flex items-center justify-center bg-gradient-to-br from-gray-300 to-gray-500 border-4 border-gray-400 shadow-xl shadow-gray-500/50",children:(0,a.jsx)(q.A,{className:"h-7 w-7 text-white"})}):2===e?(0,a.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center bg-gradient-to-br from-amber-400 to-amber-600 border-4 border-amber-500 shadow-lg shadow-amber-500/50",children:(0,a.jsx)(q.A,{className:"h-6 w-6 text-white"})}):(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-gradient-to-br from-blue-400 to-blue-600 border-2 border-blue-500",children:(0,a.jsx)("span",{className:"text-white font-bold",children:e+1})}),y=e=>{let s=["\uD83C\uDFC6 Champion","\uD83E\uDD48 Runner-up","\uD83E\uDD49 Third Place","â­ Player"];return s[Math.min(e,s.length-1)]},N=async()=>{let e=`ðŸŽ‰ Quiz Results for Lobby #${s}:

`+b.slice(0,3).map((e,s)=>`${s+1}. ${e.player_address.slice(0,6)}...${e.player_address.slice(-4)}: ${e.score} points`).join("\n");try{await navigator.clipboard.writeText(e),p({title:"Success!",description:"Results copied to clipboard!"})}catch(e){p({title:"Error",description:"Failed to copy results",variant:"destructive"})}};return(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center p-4",children:[x&&f&&(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f fixed inset-0 pointer-events-none z-10",children:[(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-yellow-600/20 animate-pulse"}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f absolute top-1/4 left-1/4 text-6xl animate-bounce",children:"\uD83C\uDF89"}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f absolute top-1/3 right-1/4 text-4xl animate-bounce delay-100",children:"\uD83C\uDFC6"}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f absolute bottom-1/3 left-1/3 text-5xl animate-bounce delay-200",children:"â­"}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f absolute bottom-1/4 right-1/3 text-4xl animate-bounce delay-300",children:"\uD83C\uDF8A"})]}),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f w-full max-w-4xl space-y-6",children:[(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f text-center space-y-4",children:[(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f flex items-center justify-center gap-3",children:[(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f p-4 rounded-2xl bg-gradient-to-br from-yellow-400 to-yellow-600 shadow-2xl",children:(0,a.jsx)($.A,{className:"h-12 w-12 text-white"})}),(0,a.jsx)("h1",{className:"jsx-169e2a3dca20af5f text-4xl font-bold bg-gradient-to-r from-yellow-600 to-orange-600 bg-clip-text text-transparent",children:"\uD83C\uDF89 Quiz Complete!"})]}),f&&(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f bg-gradient-to-r from-yellow-200 to-orange-200 border-2 border-yellow-400 rounded-2xl p-6 shadow-xl animate-pulse",children:(0,a.jsxs)("h2",{className:"jsx-169e2a3dca20af5f text-3xl font-bold text-gray-900 flex items-center justify-center gap-3",children:[(0,a.jsx)(C.A,{className:"h-8 w-8 text-yellow-600"}),"Congratulations! You're the Champion! \uD83C\uDFC6",(0,a.jsx)(C.A,{className:"h-8 w-8 text-yellow-600"})]})}),(0,a.jsxs)("p",{className:"jsx-169e2a3dca20af5f text-gray-600 text-lg",children:["Final Results for Lobby #",s]})]}),(0,a.jsxs)(d.Zp,{className:"border-0 shadow-2xl bg-white/95 backdrop-blur-sm",children:[(0,a.jsx)(d.aR,{className:"pb-4",children:(0,a.jsxs)(d.ZB,{className:"flex items-center justify-center gap-3 text-2xl",children:[(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f p-2 rounded-xl bg-gradient-to-br from-purple-500 to-blue-600",children:(0,a.jsx)(Q.A,{className:"h-6 w-6 text-white"})}),(0,a.jsx)("span",{className:"jsx-169e2a3dca20af5f bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"Final Leaderboard"})]})}),(0,a.jsx)(d.Wu,{className:"space-y-4",children:b.map((e,s)=>{let r=t&&e.player_address.toLowerCase()===t.toLowerCase();return(0,a.jsx)("div",{style:{animationDelay:`${200*s}ms`,animation:x?"slideInUp 0.6s ease-out forwards":"none"},className:`jsx-169e2a3dca20af5f relative overflow-hidden rounded-2xl border-2 transition-all duration-500 ${0===s?"bg-gradient-to-r from-yellow-50 to-yellow-100 border-yellow-300 shadow-xl shadow-yellow-500/30 scale-105":1===s?"bg-gradient-to-r from-gray-50 to-gray-100 border-gray-300 shadow-lg shadow-gray-500/30":2===s?"bg-gradient-to-r from-amber-50 to-amber-100 border-amber-300 shadow-lg shadow-amber-500/30":"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 hover:border-blue-300"} ${r?"ring-4 ring-blue-400 ring-opacity-50":""}`,children:(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f flex items-center justify-between p-6",children:[(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f flex items-center gap-6",children:[j(s),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f space-y-2",children:[(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f flex items-center gap-3",children:[(0,a.jsx)("p",{className:`jsx-169e2a3dca20af5f font-bold text-lg font-mono ${r?"text-blue-700":"text-gray-900"}`,children:r?"You":`${e.player_address.slice(0,6)}...${e.player_address.slice(-4)}`}),r&&(0,a.jsxs)(c.E,{className:"bg-blue-500 text-white",children:[(0,a.jsx)(Z.A,{className:"h-3 w-3 mr-1"}),"You"]}),(0,a.jsx)(c.E,{className:`${0===s?"bg-yellow-500 text-white":1===s?"bg-gray-500 text-white":2===s?"bg-amber-600 text-white":"bg-blue-100 text-blue-700"}`,children:y(s)})]}),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("span",{className:"jsx-169e2a3dca20af5f flex items-center gap-1",children:[(0,a.jsx)(E.A,{className:"h-4 w-4"}),e.correct_answers,"/",e.total_questions," correct"]}),e.time_bonus>0&&(0,a.jsxs)("span",{className:"jsx-169e2a3dca20af5f flex items-center gap-1 text-green-600",children:[(0,a.jsx)(k.A,{className:"h-4 w-4"}),"+",e.time_bonus," time bonus"]}),(0,a.jsxs)("span",{className:"jsx-169e2a3dca20af5f flex items-center gap-1",children:[(0,a.jsx)(O,{className:"h-4 w-4"}),Math.round(e.correct_answers/e.total_questions*100),"% accuracy"]})]})]})]}),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f text-right",children:[(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f flex items-center gap-3",children:[(0,a.jsx)("span",{className:`jsx-169e2a3dca20af5f text-4xl font-bold ${0===s?"text-yellow-600":1===s?"text-gray-600":2===s?"text-amber-600":"text-blue-600"}`,children:e.score.toLocaleString()}),0===s&&(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f animate-bounce",children:(0,a.jsx)(C.A,{className:"h-8 w-8 text-yellow-500"})})]}),(0,a.jsx)("p",{className:"jsx-169e2a3dca20af5f text-sm font-medium text-gray-500",children:"points"})]})]})},`final-${e.player_address}-${s}`)})})]}),(0,a.jsx)(d.Zp,{className:"border-0 shadow-xl bg-white/95 backdrop-blur-sm",children:(0,a.jsx)(d.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f grid grid-cols-2 md:grid-cols-4 gap-6 text-center",children:[(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f space-y-2",children:[(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-3xl font-bold text-blue-600",children:b.length}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-sm text-gray-600",children:"Total Players"})]}),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f space-y-2",children:[(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-3xl font-bold text-green-600",children:Math.round(b.reduce((e,s)=>e+s.score,0)/b.length)}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-sm text-gray-600",children:"Average Score"})]}),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f space-y-2",children:[(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-3xl font-bold text-purple-600",children:b.reduce((e,s)=>e+s.correct_answers,0)}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-sm text-gray-600",children:"Total Correct"})]}),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f space-y-2",children:[(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-3xl font-bold text-orange-600",children:u?.score||0}),(0,a.jsx)("div",{className:"jsx-169e2a3dca20af5f text-sm text-gray-600",children:"Highest Score"})]})]})})}),(0,a.jsxs)("div",{className:"jsx-169e2a3dca20af5f flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsxs)(o.$,{onClick:N,variant:"outline",size:"lg",className:"flex items-center gap-2 hover:bg-blue-50 border-blue-200",children:[(0,a.jsx)(U,{className:"h-5 w-5"}),"Copy Results"]}),(0,a.jsxs)(o.$,{onClick:()=>{let e=`Just finished a QuizCraft game in Lobby #${s}! ðŸŽ®`,t=window.location.origin,a=`https://twitter.com/intent/tweet?text=${encodeURIComponent(e)}&url=${encodeURIComponent(t)}`;window.open(a,"_blank")},variant:"outline",size:"lg",className:"flex items-center gap-2 hover:bg-blue-50 border-blue-200",children:[(0,a.jsx)(W,{className:"h-5 w-5"}),"Share on Twitter"]}),r&&(0,a.jsxs)(o.$,{onClick:r,size:"lg",className:"flex items-center gap-2 bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white",children:[(0,a.jsx)(k.A,{className:"h-5 w-5"}),"Play Again"]}),i&&(0,a.jsxs)(o.$,{onClick:i,variant:"outline",size:"lg",className:"flex items-center gap-2 hover:bg-gray-50",children:[(0,a.jsx)(I.A,{className:"h-5 w-5"}),"Back to Lobby"]})]})]}),(0,a.jsx)(l(),{id:"169e2a3dca20af5f",children:"@-webkit-keyframes slideInUp{from{opacity:0;-webkit-transform:translatey(30px);transform:translatey(30px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideInUp{from{opacity:0;-moz-transform:translatey(30px);transform:translatey(30px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideInUp{from{opacity:0;-o-transform:translatey(30px);transform:translatey(30px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideInUp{from{opacity:0;-webkit-transform:translatey(30px);-moz-transform:translatey(30px);-o-transform:translatey(30px);transform:translatey(30px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}"})]})}function B({lobbyId:e,players:s,category:t,onGameEnd:r,onScoreUpdate:l,questionDurationSec:i,seed:x,currentPlayerAddress:m}){let[u,h]=(0,n.useState)("waiting"),[f,g]=(0,n.useState)(0),[b,p]=(0,n.useState)([]),[j,y]=(0,n.useState)(null),[N,w]=(0,n.useState)(!1),[v,A]=(0,n.useState)(!0),[S,C]=(0,n.useState)(i),[k,$]=(0,n.useState)({}),[z,P]=(0,n.useState)(!1),[L,M]=(0,n.useState)([]),[F,D]=(0,n.useState)(null),[q,Q]=(0,n.useState)(!1),[Z,O]=(0,n.useState)(null),[U,W]=(0,n.useState)(null),[B,Y]=(0,n.useState)([]),[X,H]=(0,n.useState)(null),[J,V]=(0,n.useState)(!1),K=(0,n.useCallback)(e=>{if(0===b.length)return;Q(!0);let s=Date.now()-e,t=Math.floor(s/(1e3*i)),a=s%(1e3*i),r=Math.max(0,i-Math.floor(a/1e3)),l=Math.min(t,b.length-1);if(t>=b.length){ee();return}g(l),C(r);let n=l,o=setInterval(()=>{let s=Date.now()-e,t=Math.floor(s/(1e3*i)),a=s%(1e3*i),r=Math.max(0,i-Math.floor(a/1e3)),l=Math.min(t,b.length-1);if(t>=b.length){clearInterval(o),ee();return}l!==n&&(console.log(`SynchronizedQuizGame question changed from ${n} to ${l}, resetting selection`),n=l,g(l),y(null),w(!1),A(!0),P(!1)),C(r)},100);return()=>clearInterval(o)},[b.length,i,b]);(0,n.useCallback)(e=>{let s=e;W(s);let t=setInterval(()=>{W(s-=1),s<=0&&(clearInterval(t),h("playing"),K(Z))},1e3)},[Z,K]);let ee=async()=>{if(J){console.log("Synchronized scores already submitted, skipping duplicate submission");return}h("finished"),Q(!1),V(!0);let a=0;try{let s=sessionStorage.getItem(`quizcraft:scores:${e}`);if(s){let e=JSON.parse(s);for(let[s,t]of Object.entries(e))if(s.toLowerCase()===m.toLowerCase()){a=Number(t);break}}}catch(e){console.error("Error getting sessionStorage scores:",e)}0===a&&(a=k[m]||0),console.log("SynchronizedQuizGame final score:",a,"from playerScores:",k[m]);let l=Math.floor(a/100),n=a%100,i=s.map(e=>{if(e.toLowerCase()===m.toLowerCase())return{player:e,score:a,correctAnswers:l,totalQuestions:b.length,timeBonus:n};{let s=B.find(s=>s.address.toLowerCase()===e.toLowerCase()),t=s?.score||0;return{player:e,score:t,correctAnswers:Math.floor(t/100),totalQuestions:b.length,timeBonus:t%100}}});M(i),r(i);let o={lobbyId:e,players:s,scores:s.map(e=>{let s=i.find(s=>s.player.toLowerCase()===e.toLowerCase());return s?.score||0}),detailedResults:i,timestamp:Date.now(),status:"completed",totalQuestions:b.length,category:t||"Technology",currentPlayerAddress:m,currentPlayerScore:a,synchronized:!0};localStorage.setItem(`quizcraft:lobby-scores:${e}`,JSON.stringify(o)),sessionStorage.setItem(`quizcraft:local-scores:${e}`,JSON.stringify(o));try{let s={player_address:m,score:a,correct_answers:l,total_questions:b.length,time_bonus:n};console.log("Submitting synchronized game score to Supabase:",s),await fetch("/api/scores/upsert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lobbyId:Number(e),results:[s]})}),console.log("Synchronized game score submitted successfully to Supabase")}catch(e){console.error("Failed to submit synchronized game score to Supabase:",e)}console.log("Synchronized game results stored:",o)},es=e=>{if(console.log(`SynchronizedQuizGame handleAnswerSelect: answerIndex=${e}, selectedAnswer=${j}, gameState=${u}, currentQuestion=${f}`),null!==j||N||"playing"!==u){console.log(`SynchronizedQuizGame answer selection blocked: selectedAnswer=${j}, isAnswered=${N}, gameState=${u}`);return}let s=b[f];if(!s)return;y(s=>null!==s?(console.log(`SynchronizedQuizGame selection already exists: ${s}, ignoring new selection: ${e}`),s):(console.log(`SynchronizedQuizGame setting selection to: ${e}`),e)),w(!0),A(!1),P(!0);let t=e===s.correctAnswer,a=Math.floor(2*S),r=t?100+a:-25;console.log(`SynchronizedQuizGame score update: correct=${t}, timeBonus=${a}, points=${r}, timeLeft=${S}`),$(e=>{let s=e[m]||0,t=Math.max(0,s+r),a={...e,[m]:t};return console.log(`SynchronizedQuizGame scores updated: ${s} + ${r} = ${t}`,a),l&&l(a),a})};if("waiting"===u)return(0,a.jsx)(d.Zp,{className:"mb-8",children:(0,a.jsx)(d.Wu,{className:"p-8 text-center",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto",children:(0,a.jsx)(T.A,{className:"h-8 w-8 text-blue-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-blue-600",children:"Waiting for Game Start"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"The quiz will begin when all players are ready and synchronized."}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[s.length," players connected"]})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-4 p-2 bg-gray-100 rounded",children:["Debug: gameState=",u,", questions.length=",b.length,", gameStartTime=",Z,", countdown=",U]})]})})});if("countdown"===u)return(0,a.jsx)(d.Zp,{className:"mb-8",children:(0,a.jsx)(d.Wu,{className:"p-8 text-center",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"text-8xl font-bold text-green-600 mb-4 animate-pulse",children:U}),(0,a.jsx)("h2",{className:"text-3xl font-bold text-green-600 mb-2",children:"Get Ready!"}),(0,a.jsx)("p",{className:"text-xl text-muted-foreground",children:"The synchronized quiz battle is about to begin!"}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[s.length," players ready"]}),(0,a.jsx)(E.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"All questions start together"})]})]})})});if("finished"===u){let s=L.map(e=>({player_address:e.player,score:e.score,correct_answers:e.correctAnswers,total_questions:e.totalQuestions,time_bonus:e.timeBonus,has_played:!0}));return(0,a.jsx)(G,{results:s,lobbyId:e,currentPlayerAddress:m})}if("playing"===u&&b.length>0){let e=b[f];return e?(0,a.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[q&&(0,a.jsx)(d.Zp,{className:"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950",children:(0,a.jsx)(d.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 text-green-700 dark:text-green-300",children:[(0,a.jsx)(_,{className:"h-5 w-5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium",children:"Synchronized Quiz Active"}),(0,a.jsx)("p",{className:"text-sm opacity-80",children:"All players are answering the same questions at the same time!"})]})]})})}),(0,a.jsx)(R,{currentQuestion:f,totalQuestions:b.length,playerScore:k[m]||0,timeRemaining:S,questionDuration:i,playersFinished:B.length,totalPlayers:s.length,isLastQuestion:f===b.length-1,questionSource:F}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(d.ZB,{className:"text-xl",children:[e.category," - ",e.difficulty]}),(0,a.jsxs)(c.E,{variant:"outline",className:"bg-green-100 text-green-800",children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1"}),"Question ",f+1]})]})}),(0,a.jsxs)(d.Wu,{className:"space-y-6",children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:e.question}),(0,a.jsx)("div",{className:"grid gap-3",children:e.options.map((s,t)=>(0,a.jsxs)(o.$,{variant:j===t?"default":"outline",className:`p-4 h-auto text-left justify-start ${null!==j&&t===e.correctAnswer?"bg-green-500 hover:bg-green-600 text-white":j===t&&j!==e.correctAnswer?"bg-red-500 hover:bg-red-600 text-white":null!==j?"opacity-50":"hover:bg-blue-50"}`,onClick:()=>es(t),disabled:null!==j||N||"playing"!==u,children:[(0,a.jsxs)("span",{className:"font-medium mr-3",children:[String.fromCharCode(65+t),"."]}),s]},t))}),z&&(0,a.jsx)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Explanation:"})," ",e.explanation]})}),N&&(0,a.jsxs)("div",{className:"mt-4 text-center p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsx)("p",{className:"text-blue-800 font-medium",children:f<b.length-1?`Waiting for next question... (${f+1}/${b.length})`:`Final question completed! (${f+1}/${b.length})`}),(0,a.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"All players will advance together automatically"})]})]})]}),X&&(0,a.jsx)(d.Zp,{className:"border-red-200 bg-red-50",children:(0,a.jsx)(d.Wu,{className:"p-4",children:(0,a.jsx)("p",{className:"text-red-800 text-sm",children:X})})})]}):(0,a.jsx)(d.Zp,{className:"mb-8",children:(0,a.jsx)(d.Wu,{className:"p-8 text-center",children:(0,a.jsxs)("div",{className:"text-lg text-muted-foreground",children:["Loading question ",f+1,"..."]})})})}return(0,a.jsx)(d.Zp,{className:"mb-8",children:(0,a.jsx)(d.Wu,{className:"p-8 text-center",children:(0,a.jsx)("div",{className:"text-lg text-muted-foreground",children:"Preparing synchronized quiz..."})})})}var Y=t(78122);function X({lobbyId:e,refreshInterval:s=5e3,gameState:t="waiting",currentPlayerAddress:r}){let[l,i]=(0,n.useState)([]),[x,m]=(0,n.useState)(!0),[u,h]=(0,n.useState)(null),[f,g]=(0,n.useState)(null);if(!e||"undefined"===e||"null"===e)return(0,a.jsx)(d.Zp,{className:"mb-8 border-0 shadow-xl bg-gradient-to-br from-white via-red-50/30 to-red-50/30 backdrop-blur-sm",children:(0,a.jsxs)(d.Wu,{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)($.A,{className:"h-8 w-8 text-red-500"})}),(0,a.jsx)("p",{className:"text-red-600 font-medium",children:"Invalid lobby ID. Please check the URL."})]})});let b=async()=>{try{if(m(!0),!e||"undefined"===e||"null"===e)throw Error("Invalid lobby ID");console.log("Fetching scores for lobbyId:",e);let s=await fetch(`/api/scores/all-players?lobbyId=${e}`);if(!s.ok){let e;console.error("Response not OK:",{status:s.status,statusText:s.statusText,url:s.url});try{e=await s.json(),console.error("API Error Data:",e)}catch(t){console.error("Failed to parse error response as JSON:",t),e={error:`HTTP ${s.status}: ${s.statusText}`}}throw Error(e.error||`HTTP ${s.status}: ${s.statusText}`)}let t=await s.json();console.log("Fetched scores data:",t),console.log("Debug info:",t.debug),i(t.players||[]),g(new Date),h(null)}catch(e){console.error("Error fetching real-time scores:",e),h(e.message||"Failed to fetch scores")}finally{m(!1)}},p=(e,s)=>s?0===e?(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-gradient-to-br from-yellow-400 to-yellow-600 border-2 border-yellow-500 shadow-lg shadow-yellow-500/30",children:(0,a.jsx)(C.A,{className:"h-5 w-5 text-white"})}):1===e?(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-gradient-to-br from-gray-300 to-gray-500 border-2 border-gray-400 shadow-lg shadow-gray-500/30",children:(0,a.jsx)(q.A,{className:"h-5 w-5 text-white"})}):2===e?(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-gradient-to-br from-amber-400 to-amber-600 border-2 border-amber-500 shadow-lg shadow-amber-500/30",children:(0,a.jsx)(q.A,{className:"h-5 w-5 text-white"})}):(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-gradient-to-br from-blue-400 to-blue-600 border-2 border-blue-500 shadow-md",children:(0,a.jsx)("span",{className:"text-white font-bold text-sm",children:e+1})}):(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200 border-2 border-gray-300 animate-pulse",children:(0,a.jsx)(k.A,{className:"h-5 w-5 text-gray-500"})}),j=(e,s)=>s?0===e?(0,a.jsxs)(c.E,{className:"bg-gradient-to-r from-yellow-400 to-yellow-600 text-white border-0 shadow-lg",children:[(0,a.jsx)(C.A,{className:"h-3 w-3 mr-1"}),"Champion"]}):1===e?(0,a.jsxs)(c.E,{className:"bg-gradient-to-r from-gray-400 to-gray-600 text-white border-0 shadow-lg",children:[(0,a.jsx)(q.A,{className:"h-3 w-3 mr-1"}),"Runner-up"]}):2===e?(0,a.jsxs)(c.E,{className:"bg-gradient-to-r from-amber-500 to-amber-700 text-white border-0 shadow-lg",children:[(0,a.jsx)(q.A,{className:"h-3 w-3 mr-1"}),"Third Place"]}):(0,a.jsxs)(c.E,{variant:"secondary",className:"bg-blue-50 text-blue-700 border-blue-200",children:[(0,a.jsx)(Z.A,{className:"h-3 w-3 mr-1"}),"Player"]}):(0,a.jsxs)(c.E,{variant:"outline",className:"bg-gray-50 border-gray-200 text-gray-600",children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1"}),"Waiting"]});return(0,a.jsxs)(d.Zp,{className:"mb-8 border-0 shadow-xl bg-gradient-to-br from-white via-blue-50/30 to-purple-50/30 backdrop-blur-sm",children:[(0,a.jsx)(d.aR,{className:"pb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-3 text-xl",children:[(0,a.jsx)("div",{className:"p-2 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 shadow-lg",children:(0,a.jsx)($.A,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"waiting"===t?"Lobby Players":"playing"===t?"Live Scores":"Final Results"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 font-normal",children:"waiting"===t?"Players waiting to start the game":"playing"===t?"Live on-chain scores during quiz":"Final scores and rankings"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[l.length," players"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(k.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"finished"===t?"Final scores":"Real-time updates"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[f&&(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Last updated"}),(0,a.jsx)("div",{className:"text-xs font-medium",children:f.toLocaleTimeString()})]}),(0,a.jsxs)(o.$,{onClick:b,variant:"outline",size:"sm",className:"flex items-center gap-2 hover:bg-blue-50 border-blue-200 hover:border-blue-300 transition-all duration-200",disabled:x,children:[x?(0,a.jsx)(Y.A,{className:"h-4 w-4 animate-spin text-blue-500"}):(0,a.jsx)(Y.A,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)("span",{className:"text-blue-600 font-medium",children:"Refresh"})]})]})]})}),(0,a.jsx)(d.Wu,{className:"pt-0",children:u?(0,a.jsxs)("div",{className:"p-8 text-center bg-red-50 border border-red-200 rounded-xl",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)($.A,{className:"h-8 w-8 text-red-500"})}),(0,a.jsx)("p",{className:"text-red-600 font-medium mb-4",children:u}),(0,a.jsx)(o.$,{onClick:b,variant:"outline",size:"sm",className:"bg-red-50 border-red-200 text-red-600 hover:bg-red-100",children:"Try Again"})]}):x&&0===l.length?(0,a.jsxs)("div",{className:"p-12 text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse",children:(0,a.jsx)(Y.A,{className:"h-10 w-10 animate-spin text-blue-500"})}),(0,a.jsx)("p",{className:"text-muted-foreground font-medium",children:"Loading leaderboard..."})]}):0===l.length?(0,a.jsxs)("div",{className:"p-12 text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(I.A,{className:"h-10 w-10 text-gray-400"})}),(0,a.jsx)("p",{className:"text-muted-foreground font-medium",children:"No players found in this lobby."})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[l.slice().sort((e,s)=>e.has_played!==s.has_played?s.has_played?1:-1:s.score-e.score).map((e,s)=>{let t=l.filter(e=>e.has_played).findIndex(s=>s.player_address===e.player_address),n=e.has_played&&t>=0&&t<3,i=r&&e.player_address.toLowerCase()===r.toLowerCase();return(0,a.jsxs)("div",{className:`group relative overflow-hidden rounded-2xl border-2 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg ${i?"bg-gradient-to-r from-green-50 to-emerald-50 border-green-300 ring-2 ring-green-400 ring-opacity-50 shadow-lg shadow-green-500/20":n&&0===t?"bg-gradient-to-r from-yellow-50 to-yellow-100 border-yellow-300 shadow-lg shadow-yellow-500/20":n&&1===t?"bg-gradient-to-r from-gray-50 to-gray-100 border-gray-300 shadow-lg shadow-gray-500/20":n&&2===t?"bg-gradient-to-r from-amber-50 to-amber-100 border-amber-300 shadow-lg shadow-amber-500/20":e.has_played?"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 hover:border-blue-300":"bg-gradient-to-r from-gray-50 to-slate-50 border-gray-200 hover:border-gray-300"}`,children:[(0,a.jsx)("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-300 ${n&&0===t?"bg-gradient-to-r from-yellow-400 to-yellow-600":n&&1===t?"bg-gradient-to-r from-gray-400 to-gray-600":n&&2===t?"bg-gradient-to-r from-amber-400 to-amber-600":"bg-gradient-to-r from-blue-400 to-indigo-600"}`}),(0,a.jsxs)("div",{className:"relative flex items-center justify-between p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[p(t,e.has_played),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900 font-mono",children:i?"You":`${e.player_address.slice(0,6)}...${e.player_address.slice(-4)}`}),i&&(0,a.jsxs)(c.E,{className:"bg-green-500 text-white border-0 shadow-lg",children:[(0,a.jsx)(Z.A,{className:"h-3 w-3 mr-1"}),"You"]}),!i&&j(t,e.has_played)]}),e.has_played&&(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(E.A,{className:"h-3 w-3"}),e.correct_answers,"/",e.total_questions," correct"]}),e.time_bonus>0&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:[(0,a.jsx)(k.A,{className:"h-3 w-3"}),"+",e.time_bonus," time bonus"]})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:`text-3xl font-bold ${n&&0===t?"text-yellow-600":n&&1===t?"text-gray-600":n&&2===t?"text-amber-600":e.has_played?"text-blue-600":"text-gray-500"}`,children:e.score.toLocaleString()}),n&&0===t&&(0,a.jsx)("div",{className:"animate-bounce",children:(0,a.jsx)(C.A,{className:"h-6 w-6 text-yellow-500"})})]}),(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"points"})]})]})]},`realtime-${e.player_address}-${s}`)}),l.length>0&&(0,a.jsx)("div",{className:"mt-6 p-4 bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl border border-gray-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:l.length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Players"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:l.filter(e=>e.has_played).length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Completed"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:l.filter(e=>!e.has_played).length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Waiting"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:l.length>0?Math.round(l.reduce((e,s)=>e+s.score,0)/l.length):0}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Avg Score"})]})]})})]})})]})}function H(){var e;let s=(0,i.useParams)(),t=(0,i.useRouter)(),{toast:r}=function(){let[e,s]=n.useState(g);return n.useEffect(()=>(f.push(s),()=>{let e=f.indexOf(s);e>-1&&f.splice(e,1)}),[e]),{...e,toast:p,dismiss:e=>b({type:"DISMISS_TOAST",toastId:e})}}(),{signer:x,isConnected:m,isOnConflux:u,account:h}=(0,j.$)(),[z,E]=(0,n.useState)(null),[R,q]=(0,n.useState)(!0),[Q,Z]=(0,n.useState)([]),[O,U]=(0,n.useState)(!1),[W,G]=(0,n.useState)(!1),[Y,H]=(0,n.useState)([]),[J,V]=(0,n.useState)(null),[K,ee]=(0,n.useState)(!1),[es,et]=(0,n.useState)(null),[ea,er]=(0,n.useState)(null),[el,en]=(0,n.useState)(null),[ei,eo]=(0,n.useState)(null),[ed,ec]=(0,n.useState)(!1),[ex,em]=(0,n.useState)(null),[eu,eh]=(0,n.useState)(!1),[ef,eg]=(0,n.useState)(!1),[eb,ep]=(0,n.useState)([]),[ej,ey]=(0,n.useState)([]),[eN,ew]=(0,n.useState)(!1),[ev,eA]=(0,n.useState)(null),[eS,eC]=(0,n.useState)(null),[ek,e$]=(0,n.useState)(!1),[ez,e_]=(0,n.useState)(null),eP=s.lobbyId,eI=Number(eP),[eL,eT]=(0,n.useState)(!1),eM=O||K||3===ev,eF=!O&&(K||3===ev),eD=K||3===ev,eE=async()=>{console.log("Lobby page loaded for lobbyId:",eP),console.log("isConnected:",m,"isOnConflux:",u,"account:",h);try{let e=new y.FR(A.qQ.rpcUrl),s=new N.NZ(v.QX.QUIZ_CRAFT_ARENA,v.UN,e),t=await s.lobbies(eI);console.log("Raw lobby data from contract:",t);let a=t[11],r=t[10];console.log("Creator address (index 11):",a),console.log("Winner address (index 10):",r);let l=w.ck(t.entryFee),n=Number(t.status);eA(n);let i=Number(t.playerCount),o=Number(t.maxPlayers),d="";0===n?d=0===i?"Waiting for players":`${i}/${o} players`:1===n?d=ed?"Game Completed":W?"Game in progress":i>=o?"All players joined - Game starting soon":`${i}/${o} players - Waiting for more players`:2===n?d="Game in progress":3===n?d="Completed":4===n&&(d="Cancelled");let c=await s.getPlayersInLobby(eI),x=!1;if(h){try{x=await s.isPlayerInLobby(eI,h),console.log("Contract membership check (primary):",x)}catch(e){console.error("Contract membership check (primary) failed:",e)}if(!x)try{let s=new N.NZ(v.QX.QUIZ_CRAFT_ARENA,v.UN,e);x=await s.isPlayerInLobby(eI,h),console.log("Contract membership check (secondary):",x)}catch(e){console.error("Contract membership check (secondary) failed:",e)}if(!x){let e=h.toLowerCase();x=c.some(s=>s.toLowerCase()===e),console.log("Players list fallback check:",x)}try{x&&sessionStorage.setItem(`quizcraft:joined:${eP}:${h.toLowerCase()}`,"true")}catch{}!x&&eL&&(x=!0,console.log("Session hint fallback:",x)),console.log("Final membership result:",{lobbyId:eI,account:h,userInLobby:x})}let m={id:String(t.id),name:t.name,category:t.category,mode:`ðŸŽ¯ ${t.name}`,entryFee:l,currentPlayers:i,maxPlayers:o,isActive:0===n&&i<o,creator:a,status:d,isUserInLobby:x};E(m),Z(c),U(x);let u=1===t.distribution;console.log("Contract distribution status:",t.distribution,"isDistributed:",u),eC(u);try{let e=t.createdAt,a=await s.LOBBY_TIMEOUT(),r=Math.floor(Date.now()/1e3),l=Number(e+a),n=Math.max(0,l-r);V(n),ee(0===n),er(Number(e)),en(l),eo(Number(a))}catch(e){}if(3===n){ec(!0),G(!1);try{let e=await fetch(`/api/scores/all-players?lobbyId=${eP}`);if(e.ok){let s=await e.json();if(s.players&&s.players.length>0){let e=s.players.filter(e=>e.has_played);if(e.length>0){let s=e.reduce((e,s)=>e.score>s.score?e:s);em(s.player_address),console.log("Winner determined from Supabase scores:",s.player_address,"with score:",s.score)}}}}catch(e){console.error("Error fetching winner from Supabase:",e),em(t.winner)}}}catch(e){console.error("Error fetching lobby details:",e)}finally{q(!1)}},eR=async()=>{if(x&&z?.creator&&z.creator.toLowerCase()===h?.toLowerCase()){e$(!0),r({title:"â³ Resolving Prize...",description:"Processing prize distribution on-chain. Please wait.",duration:3e3});try{let e=null;try{let s=await fetch(`/api/scores/all-players?lobbyId=${eP}`);if(s.ok){let t=await s.json();if(t.players&&t.players.length>0){let s=t.players.filter(e=>e.has_played);if(s.length>0){let t=s.reduce((e,s)=>e.score>s.score?e:s);e=t.player_address,console.log("Winner for prize resolution determined from Supabase scores:",t.player_address,"with score:",t.score)}}}}catch(e){console.error("Error fetching winner from Supabase:",e)}if(e||(e=ex,console.log("Using fallback winner from state:",e)),!e){r({title:"âŒ Cannot Resolve Prize",description:"Could not determine winner. Please try again.",variant:"destructive",duration:5e3});return}let s=new N.NZ(v.QX.QUIZ_CRAFT_ARENA,v.UN,x),t=await s.executeWinnerPayout(eI,e);console.log("executeWinnerPayout transaction sent:",t.hash);let l=await t.wait();console.log("Prize payout transaction confirmed:",l),r({title:"\uD83C\uDFC6 Prize Resolved Successfully!",description:"The winner has received the prize pool!",duration:6e3,action:(0,a.jsx)("a",{href:`https://evmtestnet.confluxscan.org/tx/${t.hash}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline text-sm",children:"View Transaction"})}),console.log("Setting prizeDistributedOnChain to true after successful distribution"),eC(!0),setTimeout(()=>{eE()},2e3)}catch(e){console.error("resolvePrizeAsCreator error",e),r({title:"âŒ Prize Resolution Failed",description:e?.message||"Failed to resolve prize. Please try again.",variant:"destructive",duration:5e3})}finally{e$(!1)}}},eq=e=>{if(null===e)return"Unknown";switch(e){case 0:return"OPEN";case 1:return"FULL";case 2:return"IN_PROGRESS";case 3:return"COMPLETED";case 4:return"CANCELLED";default:return"Unknown"}},eQ=(e,s)=>{let t=Math.max(0,Math.abs(e-Math.floor(Date.now()/1e3))),a=Math.floor(t/60),r=t%60;return a>0?s?`in ${a}m ${r}s`:`${a}m ${r}s ago`:s?`in ${r}s`:`${r}s ago`};return R?(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf max-w-4xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf relative overflow-hidden rounded-xl border border-muted/30 bg-gradient-to-r from-muted/40 via-muted/60 to-muted/40",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/20 to-transparent animate-[shimmer_1.6s_infinite]"}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf p-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf space-y-2",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-6 w-40 bg-white/20 rounded"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-4 w-64 bg-white/10 rounded"})]}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf flex items-center gap-3",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-10 w-10 rounded-lg bg-white/20"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-10 w-28 rounded-lg bg-white/20"})]})]})]}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf grid grid-cols-1 md:grid-cols-3 gap-6",children:[0,1,2].map(e=>(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf relative overflow-hidden rounded-xl border border-muted/30 bg-card p-5",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent animate-[shimmer_1.6s_infinite]"}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf flex items-center gap-3",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-10 w-10 rounded-lg bg-muted"}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf space-y-2 w-full",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-3 w-24 bg-muted rounded"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-4 w-32 bg-muted rounded"})]})]})]},e))}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf relative overflow-hidden rounded-xl border border-muted/30 bg-card p-6",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent animate-[shimmer_1.6s_infinite]"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-5 w-40 bg-muted rounded mb-4"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf space-y-3",children:[0,1,2,3].map(e=>(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf flex items-center gap-3",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-8 w-8 rounded-full bg-muted"}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf space-y-2 w-full",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-3 w-28 bg-muted rounded"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-3 w-40 bg-muted/80 rounded"})]})]},e))})]}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf relative overflow-hidden rounded-xl border border-muted/30 bg-card p-6",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent animate-[shimmer_1.6s_infinite]"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-5 w-48 bg-muted rounded mb-4"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf space-y-3",children:[0,1,2].map(e=>(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf flex items-center justify-between p-3 rounded-lg border bg-muted/20",children:[(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf flex items-center gap-3",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-8 w-8 rounded-full bg-muted"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-4 w-32 bg-muted rounded"})]}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf h-4 w-16 bg-muted rounded"})]},e))})]})]}),(0,a.jsxs)("div",{className:"jsx-45d27ee17459fedf relative overflow-hidden rounded-xl border border-muted/30 bg-card p-8 text-center",children:[(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent animate-[shimmer_1.6s_infinite]"}),(0,a.jsx)("div",{className:"jsx-45d27ee17459fedf mx-auto h-10 w-40 bg-muted rounded"})]})]}),(0,a.jsx)(l(),{id:"45d27ee17459fedf",children:"@-webkit-keyframes shimmer{100%{-webkit-transform:translatex(100%);transform:translatex(100%)}}@-moz-keyframes shimmer{100%{-moz-transform:translatex(100%);transform:translatex(100%)}}@-o-keyframes shimmer{100%{-o-transform:translatex(100%);transform:translatex(100%)}}@keyframes shimmer{100%{-webkit-transform:translatex(100%);-moz-transform:translatex(100%);-o-transform:translatex(100%);transform:translatex(100%)}}"})]}):z?R||eM||!h||eL?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)(o.$,{onClick:()=>t.push("/arena"),variant:"outline",className:"flex items-center gap-2",children:[(0,a.jsx)(P,{className:"h-4 w-4"}),"Back to Arena"]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold",children:["Lobby #",eP]}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[z.status," (",eq(ev),")"]}),eF&&(0,a.jsxs)(c.E,{className:"mt-2 bg-blue-100 text-blue-800 border-blue-300",children:[(0,a.jsx)($.A,{className:"h-3 w-3 mr-1"}),"Viewing Results"]}),eD&&!O&&(0,a.jsxs)(c.E,{className:"mt-2 bg-green-100 text-green-800 border-green-300",children:[(0,a.jsx)(I.A,{className:"h-3 w-3 mr-1"}),"Open to Everyone"]})]})]}),(0,a.jsxs)(d.Zp,{className:"mb-8",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-3",children:[(e=z.mode).includes("Duel")?(0,a.jsx)(S.A,{className:"h-6 w-6"}):e.includes("Royale")?(0,a.jsx)(C.A,{className:"h-6 w-6"}):e.includes("Quick")?(0,a.jsx)(k.A,{className:"h-6 w-6"}):e.includes("Championship")?(0,a.jsx)($.A,{className:"h-6 w-6"}):(0,a.jsx)(_,{className:"h-6 w-6"}),z.mode]}),!W&&!ed&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(c.E,{variant:"default",className:"bg-green-100 text-green-800 border-green-300",children:[(0,a.jsx)(k.A,{className:"h-3 w-3 mr-1"}),"Synchronized"]})})]})}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(L.A,{className:"h-5 w-5 text-yellow-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Entry Fee"}),(0,a.jsxs)("p",{className:"font-semibold",children:[z.entryFee," CFX"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(I.A,{className:"h-5 w-5 text-blue-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Players"}),(0,a.jsxs)("p",{className:"font-semibold",children:[z.currentPlayers,"/",z.maxPlayers]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)($.A,{className:"h-5 w-5 text-purple-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Prize Pool"}),(0,a.jsxs)("p",{className:"font-semibold",children:[(Number.parseFloat(z.entryFee)*z.maxPlayers).toFixed(1)," CFX"]})]})]})]}),(K||3===ev)&&ex&&(0,a.jsx)("div",{className:"mt-6 p-6 bg-gradient-to-r from-yellow-100 to-orange-100 border-2 border-yellow-300 rounded-xl shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-md",children:(0,a.jsx)(C.A,{className:"h-7 w-7 text-white"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-yellow-800 mb-1 winner-text",children:"\uD83C\uDFC6 Winner"}),(0,a.jsxs)("p",{className:"font-bold text-xl text-black mb-1 winner-text",children:[ex.slice(0,6),"...",ex.slice(-4)]}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-orange-700 px-3 py-1 rounded-full inline-block winner-prize",children:["Prize: ",(Number.parseFloat(z.entryFee)*z.maxPlayers).toFixed(1)," CFX"]})]})]})})]})]}),(0,a.jsxs)(d.Zp,{className:"mb-8",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(T.A,{className:"h-5 w-5"}),"Lobby Details"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(_,{className:"h-4 w-4 text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Status"}),(0,a.jsx)("p",{className:"font-semibold",children:eq(ev)})]})]}),null!==ea&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(T.A,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,a.jsxs)("p",{className:"font-semibold",children:[new Date(1e3*ea).toLocaleString()," ",(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",eQ(ea,!1),")"]})]}),1===ev&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Timer reset when lobby became FULL"})]})]}),null!==el&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(T.A,{className:"h-4 w-4 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Expires"}),(0,a.jsxs)("p",{className:"font-semibold",children:[new Date(1e3*el).toLocaleString()," ",(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",eQ(el,!0),")"]})]})]})]}),null!==ei&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(T.A,{className:"h-4 w-4 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Timeout Window"}),(0,a.jsxs)("p",{className:"font-semibold",children:[Math.floor(ei/60)," minutes"]})]})]}),null!==J&&!K&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(T.A,{className:"h-4 w-4 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Time Remaining"}),(0,a.jsxs)("p",{className:"font-semibold text-green-600",children:[Math.floor((J||0)/60),"m ",(J||0)%60,"s"]})]})]}),z?.creator&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(M,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Creator"}),(0,a.jsxs)("p",{className:"font-semibold",children:[z.creator.slice(0,6),"...",z.creator.slice(-4)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(F.A,{className:"h-4 w-4 text-emerald-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Prize Distributed (on-chain)"}),(0,a.jsx)("p",{className:"font-semibold",children:3===ev?"Yes":"No"})]})]})]})})]}),ed&&(0,a.jsx)(d.Zp,{className:"mb-8 border-green-200 bg-green-50",children:(0,a.jsx)(d.Wu,{className:"p-6 text-center",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-6xl",children:"\uD83C\uDFC1"}),(0,a.jsx)("h2",{className:"text-3xl font-bold text-green-700",children:"Game Over!"}),(0,a.jsx)("p",{className:"text-lg text-green-600",children:"The quiz battle has ended. Check the leaderboard below for final results."})]})})}),(!W||ed||eF)&&(0,a.jsx)(X,{lobbyId:eP,refreshInterval:3e3,gameState:ed?"finished":"waiting",currentPlayerAddress:h||void 0},`scores-${ed?"finished":"waiting"}`),z?.creator&&h&&z?.creator?.toLowerCase()===h.toLowerCase()&&ed&&(0,a.jsx)(d.Zp,{className:"mb-8",children:(0,a.jsx)(d.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-4",children:[(0,a.jsx)($.A,{className:"h-8 w-8 text-yellow-500"}),(0,a.jsx)("h3",{className:"text-xl font-semibold",children:3===ev?"Prize Pool Distributed":"Resolve Prize Pool"})]}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:3===ev?"The prize pool has been successfully distributed to the winner.":"As the lobby creator, you can resolve the prize pool and distribute it to the winner."}),3!==ev?(0,a.jsx)(o.$,{onClick:eR,disabled:ek,className:"bg-purple-600 hover:bg-purple-700 text-white",children:ek?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Resolving Prize..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.A,{className:"mr-2 h-4 w-4"}),"Resolve Prize (Creator)"]})}):(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600 font-semibold",children:[(0,a.jsx)(F.A,{className:"h-5 w-5"}),"Completed"]})]})})}),(()=>{let e=W&&!K&&!ed&&z;return console.log("Quiz rendering check:",{gameStarted:W,isExpired:K,gameFinished:ed,lobby:!!z,shouldShowQuiz:e}),e})()&&(0,a.jsx)(B,{lobbyId:eP,players:Q,category:z.category,questionDurationSec:10,seed:`${v.QX.QUIZ_CRAFT_ARENA}-${eI}-${ea||0}`,currentPlayerAddress:h||Q.find(e=>e)||"",onGameEnd:e=>{H(e),ec(!0),G(!1);try{sessionStorage.setItem(`quizcraft:finished:${eP}`,"true")}catch{}em(e.reduce((e,s)=>e.score>s.score?e:s).player),r({title:"\uD83C\uDFC1 Game Finished!",description:"Check the leaderboard below for final results!",duration:5e3}),console.log("Synchronized game ended with results:",e)},onScoreUpdate:e=>{H(Object.entries(e).map(([e,s])=>({player:e,score:s,correctAnswers:Math.floor((s||0)/100),totalQuestions:10,timeBonus:Math.floor((s||0)%100)})))}}),(0,a.jsxs)(d.Zp,{className:"mb-8",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(I.A,{className:"h-5 w-5"}),"Players (",z.currentPlayers,"/",z.maxPlayers,")"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"space-y-3",children:Q.map((e,s)=>(0,a.jsxs)("div",{className:`flex items-center justify-between p-3 rounded-lg border ${e.toLowerCase()===h?.toLowerCase()?"bg-green-50 border-green-200":"bg-muted/20"}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-sm",children:s+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.toLowerCase()===h?.toLowerCase()?"You":`${e.slice(0,6)}...${e.slice(-4)}`}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e})]})]}),e.toLowerCase()===h?.toLowerCase()&&(0,a.jsxs)(c.E,{variant:"default",className:"bg-green-500",children:[(0,a.jsx)(F.A,{className:"h-3 w-3 mr-1"}),"You"]})]},`${e}-${s}`))})})]})]})}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto text-center",children:(0,a.jsx)(d.Zp,{className:"border-2 border-yellow-500/20 bg-yellow-900/10",children:(0,a.jsxs)(d.Wu,{className:"py-16",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-yellow-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(_,{className:"h-10 w-10 text-yellow-500"})}),(0,a.jsx)("h2",{className:"font-montserrat font-bold text-3xl mb-4 text-yellow-400",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-xl text-muted-foreground mb-4",children:"You are not a member of this lobby. Please join the lobby from the arena first."}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-8",children:"Note: Expired or completed lobbies are open to anyone for viewing results."}),(0,a.jsxs)(o.$,{onClick:()=>t.push("/arena"),size:"lg",className:"bg-yellow-600 hover:bg-yellow-700 text-white font-semibold",children:[(0,a.jsx)(P,{className:"mr-3 h-5 w-5"}),"Back to Arena"]})]})})})}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto text-center",children:(0,a.jsx)(d.Zp,{className:"border-2 border-red-500/20 bg-red-900/10",children:(0,a.jsxs)(d.Wu,{className:"py-16",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-red-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(_,{className:"h-10 w-10 text-red-500"})}),(0,a.jsx)("h2",{className:"font-montserrat font-bold text-3xl mb-4 text-red-400",children:"Lobby Not Found"}),(0,a.jsx)("p",{className:"text-xl text-muted-foreground mb-8",children:"The lobby you're looking for doesn't exist or you don't have access to it."}),(0,a.jsxs)(o.$,{onClick:()=>t.push("/arena"),size:"lg",className:"bg-red-600 hover:bg-red-700 text-white font-semibold",children:[(0,a.jsx)(P,{className:"mr-3 h-5 w-5"}),"Back to Arena"]})]})})})})}},33873:e=>{"use strict";e.exports=require("path")},45583:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},48730:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64398:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},67855:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/vikashyadav/Developer/AllgitFiles/QuizCraft/Frontend/app/arena/[lobbyId]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/vikashyadav/Developer/AllgitFiles/QuizCraft/Frontend/app/arena/[lobbyId]/page.tsx","default")},74075:e=>{"use strict";e.exports=require("zlib")},77598:e=>{"use strict";e.exports=require("node:crypto")},81630:e=>{"use strict";e.exports=require("http")},86561:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])},93629:(e,s,t)=>{Promise.resolve().then(t.bind(t,67855))},95212:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d});var a=t(65239),r=t(48088),l=t(88170),n=t.n(l),i=t(30893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let d={children:["",{children:["arena",{children:["[lobbyId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,67855)),"/Users/vikashyadav/Developer/AllgitFiles/QuizCraft/Frontend/app/arena/[lobbyId]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,58014)),"/Users/vikashyadav/Developer/AllgitFiles/QuizCraft/Frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/Users/vikashyadav/Developer/AllgitFiles/QuizCraft/Frontend/app/arena/[lobbyId]/page.tsx"],x={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/arena/[lobbyId]/page",pathname:"/arena/[lobbyId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[828,243,567,16,441],()=>t(95212));module.exports=a})();